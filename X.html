<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bảng Excel 50 hàng</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      padding: 20px;
    }
    .excel {
      display: grid;
      grid-template-columns: 150px repeat(7, 250px);
      background: white;
      border: 1px solid #ccc;
      width: fit-content;
    }
    .cell {
      border: 1px solid #ccc;
      padding: 8px;
      height: 35px;
      display: flex;
      align-items: center;
      background: #fafafa;
      font-weight: bold;
    }
    .input-cell {
      border: 1px solid #ccc;
      padding: 0;
    }
    input {
      width: 100%;
      height: 100%;
      border: none;
      padding-left: 5px;
      box-sizing: border-box;
    }
  </style>
</head>
<body>

<h2>Bảng dữ liệu kiểu Excel 50 hàng</h2>

<div class="excel">
  <!-- Header -->
  <div class="cell">Hàng</div>
  <div class="cell">Instructor</div>
  <div class="cell">Instructor Rank</div>
  <div class="cell">Name Discord Instructor</div>
  <div class="cell">Name Discord Player Train</div>
  <div class="cell">Name Roblox Player</div>
  <div class="cell">Point Instructor</div>
  <div class="cell">Point Player</div>

  <!-- Rows 1–50 -->
  <!-- Mỗi row có 7 input -->
  <!-- Mình dùng loop JS để render nhanh trong HTML -->
  <script>
    const excelDiv = document.currentScript.parentElement;
    for (let i = 1; i <= 50; i++) {
      // Hàng số
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.textContent = i;
      excelDiv.appendChild(cell);

      // 7 input
      for (let j = 0; j < 7; j++) {
        const inputCell = document.createElement("div");
        inputCell.className = "input-cell";
        const input = document.createElement("input");
        inputCell.appendChild(input);
        excelDiv.appendChild(inputCell);
      }
    }
  </script>
</div>

<script>
  // Auto-save tất cả input
  function autoSave() {
    const allInputs = document.querySelectorAll(".excel input");
    const data = Array.from(allInputs).map(inp => inp.value);
    localStorage.setItem("excel_full_table", JSON.stringify(data));
  }

  // Load dữ liệu khi mở lại
  window.onload = function () {
    const saved = localStorage.getItem("excel_full_table");
    if (!saved) return;
    const data = JSON.parse(saved);
    const allInputs = document.querySelectorAll(".excel input");
    allInputs.forEach((inp, i) => { inp.value = data[i] || ""; });
  };

  // Gắn auto-save cho mọi input
  document.addEventListener("input", e => {
    if (e.target.tagName === "INPUT") autoSave();
  });
</script>

</body>
</html>
